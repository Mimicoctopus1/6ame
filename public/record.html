<!DOCTYPE html>
<html>
	<body>
		<button id="start"> Start Recording </button>
		<button id="stop" disabled> Stop Recording </button>
		<video autoplay />

		<script>
			const start = document.getElementById('start');
			const stop = document.getElementById('stop');
			const video = document.querySelector('video');
			let recorder, stream;

			async function startRecording() {
				stream = await navigator.mediaDevices.getDisplayMedia({
					video: {mediaSource: 'screen'},
				});
				recorder = new MediaRecorder(stream);

				const chunks = [];
				recorder.ondataavailable = (e) => chunks.push(e.data);
				recorder.onstop = (e) => {
					const completeBlob = new Blob(chunks, {type: chunks[0].type});
					video.src = URL.createObjectURL(completeBlob);
				};

				recorder.start();
			}

			start.addEventListener('click', function() {
				start.disabled = true;
				stop.disabled = false;

				startRecording();
			});

			stop.addEventListener('click', function() {
				stop.disabled = true;
				start.disabled = false;

				recorder.stop();
				stream.getVideoTracks()[0].stop();
			});
		</script>
	</body>
</html>
